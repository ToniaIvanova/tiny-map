(this["webpackJsonptiny-map"]=this["webpackJsonptiny-map"]||[]).push([[0],{131:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(25),o=n(27),i=n.n(o),a=n(273),s=n(54),u=n.n(s),d="PRODUCT_TAB",l="REGION_TAB",b=n(90),j=["#dc143c","#3caa3c","#156fc1","#eaec35","#942010","#0b0038","#ffb21f","#ffbcb5v","#6ac954"],p=n(8);var O=function(e){var t=e.selectedStations;return Object(p.jsx)("div",{children:t.map((function(e){var t=e.done?"#c0c0c0":j[e.colorForMap];return Object(p.jsx)(b.b,{geometry:e.place,modules:["geoObject.addon.balloon","geoObject.addon.hint"],properties:{balloonContentHeader:"".concat(e.stationName),balloonContent:"\u041f\u0440\u043e\u0434\u0443\u043a\u0442: ".concat(e.productName," --- ").concat(e.done?"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e!":"\u041d\u0430\u0434\u043e: ".concat(e.needCount)),balloonContentFooter:e.region},options:{preset:"islands#circleIcon",iconColor:t}})}))})},f={getSelectedByProductStations:function(e){return e.station.selectedByProductStations},getSelectedByRegionStations:function(e){return e.station.selectedByRegionStations}},h={getActiveTab:function(e){return e.tab.activeTab}};var g=Object(c.b)((function(e){return{selectedByProductStations:f.getSelectedByProductStations(e),selectedByRegionStations:f.getSelectedByRegionStations(e),activeTab:h.getActiveTab(e)}}))((function(e){var t=e.selectedByProductStations,n=e.selectedByRegionStations,r=e.activeTab;return Object(p.jsx)(b.c,{children:Object(p.jsxs)(b.a,{className:u.a.map,defaultState:{center:[19.441468,17.496825],zoom:2},children:[r===d&&Object(p.jsx)(O,{selectedStations:t}),r===l&&Object(p.jsx)(O,{selectedStations:n})]})})})),x=n(30),S=n.n(x),y=n(40),v=n(66),I=(n(97),n(131),n(270)),m=n(275),C=n(73),T=n(152),R="https://stormy-brook-68283.herokuapp.com",P=n.n(T).a.create({baseURL:R,timeout:2e3,headers:{"Content-Type":"application/json"}}),_=new function e(){Object(C.a)(this,e),this.getAllProducts=Object(y.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",P.get("/product"));case 1:case"end":return e.stop()}}),e)})))},w="SWITCH_ON_PRODUCT_TABLE_VISIBILITY",B="PUSH_SELECTED_PRODUCT_ID",N="INC_PRODUCT_COLOR_INDEX",U={switchOnProductTableVisibility:function(){return function(e){return e({type:w})}},pushSelectedProductId:function(e){return function(t){return t({type:B,productId:e})}},incProductColorIndex:function(e){return function(t){return t({type:N,colorIndex:e+1})}}},E={getProductTableVisibility:function(e){return e.product.productTableVisibility},getSelectedProductIds:function(e){return e.product.selectedProductIds},getNextProductColorIndex:function(e){return e.product.nextProductColorIndex}},A={getCurrentUser:function(e){return e.user.currentUser}},V="PUSH_SELECTED_BY_PRODUCT_STATIONS",D="PUSH_SELECTED_BY_REGION_STATIONS",k={pushSelectedByProductStations:function(e,t,n){return function(r){return fetch("".concat(R,"/station/product/").concat(e,"/").concat(t._id),{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return r({type:V,stationsData:e.map((function(e){return e.colorForMap=n,e}))})}))}},pushSelectedByRegionStations:function(e,t,n){return function(r){return fetch("".concat(R,"/station/region/").concat(e,"/").concat(t._id),{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return r({type:D,stationsData:e.map((function(e){return e.colorForMap=n,e}))})}))}}};var L={switchOnProductTableVisibility:U.switchOnProductTableVisibility,pushSelectedProductIds:U.pushSelectedProductId,incNextProductColor:U.incProductColorIndex,pushSelectedByProductStations:k.pushSelectedByProductStations},G=Object(c.b)((function(e){return{selectedProductIds:E.getSelectedProductIds(e),nextProductColor:E.getNextProductColorIndex(e),currentUser:A.getCurrentUser(e)}}),L)((function(e){var t=e.selectedProductIds,n=e.currentUser,c=e.nextProductColor,o=e.incNextProductColor,i=e.switchOnProductTableVisibility,a=e.pushSelectedProductIds,s=e.pushSelectedByProductStations,u=Object(r.useState)([]),d=Object(v.a)(u,2),l=d[0],b=d[1],j=Object(r.useState)([]),O=Object(v.a)(j,2),f=O[0],h=O[1],g=Object(r.useState)(""),x=Object(v.a)(g,2),C=x[0],T=x[1];return Object(r.useEffect)(Object(y.a)(S.a.mark((function e(){var t,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.getAllProducts();case 2:t=e.sent,n=t.data.map((function(e){return{value:e._id,label:e.name}})),h(n),b(n);case 6:case"end":return e.stop()}}),e)}))),[]),Object(p.jsx)("div",{className:"site-input-group-wrapper",children:Object(p.jsx)(I.a,{dropdownMatchSelectWidth:252,style:{width:300},options:l,onSelect:function(e){e&&!t.includes(e)&&(s(e,n,c),i(),a(e),o(c))},onSearch:function(e){T(e);var t=f.filter((function(t){return t.label.toString().toLowerCase().indexOf(e.toString().toLowerCase())>-1}));b(t)},value:C,children:Object(p.jsx)(m.a.Search,{size:"large",placeholder:"\u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430",enterButton:!0})})})})),F=n(271),z=n(277),H=new function e(){Object(C.a)(this,e),this.postNewStation=function(){var e=Object(y.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",P.post("/station",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.putStationDone=function(){var e=Object(y.a)(S.a.mark((function e(t){var n,r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.stationId,r=t.currentUser,c=t.done,e.next=3,P.put("/station/".concat(n,"/").concat(r._id,"/done"),{done:c});case 3:return e.abrupt("return",e.sent.data.stationDone);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},M={_id:"6103dfdc5b78f439334b5825",name:"\u0413\u043e\u0441\u0442\u044c"};var W=Object(c.b)((function(e){return{currentUser:A.getCurrentUser(e)}}))((function(e){var t=e.station,n=e.currentUser;function r(e){H.putStationDone({stationId:t.stationId,currentUser:n,done:e})}return n===M?Object(p.jsx)("div",{}):t.done?Object(p.jsx)(z.a,{onChange:r,defaultChecked:!0}):Object(p.jsx)(z.a,{onChange:r})})),K=[{title:"Product Name",dataIndex:"productName",sorter:function(e,t){return e.productName>t.productName?1:-1}},{title:"Station Name",dataIndex:"stationName"},{title:"Need Count",dataIndex:"needCount",defaultSortOrder:"descend",sorter:function(e,t){return e.needCount-t.needCount}},{title:"Done",render:function(e){return Object(p.jsx)(W,{station:e})}},{title:"region",dataIndex:"region",sorter:function(e,t){return e.region>t.region?1:-1}}];var Y=Object(c.b)((function(e){return{selectedByProductStations:f.getSelectedByProductStations(e)}}))((function(e){var t=e.selectedByProductStations;return Object(p.jsx)(F.a,{columns:K,dataSource:t,size:"middle"})}));var J=Object(c.b)((function(e){return{productTableVisability:E.getProductTableVisibility(e)}}))((function(e){var t=e.productTableVisability;return Object(p.jsxs)("div",{children:[Object(p.jsx)(G,{}),t&&Object(p.jsx)(Y,{className:u.a.table})]})})),X=new function e(){Object(C.a)(this,e),this.getAllRegions=Object(y.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",P.get("/region"));case 1:case"end":return e.stop()}}),e)})))},q="SWITCH_ON_REGION_TABLE_VISIBILITY",Q="PUSH_SELECTED_REGIONS_ID",Z="INC_REGION_COLOR_INDEX",$={switchOnRegionTableVisibility:function(){return function(e){return e({type:q})}},pushSelectedRegionId:function(e){return function(t){return t({type:Q,regionId:e})}},incRegionColorIndex:function(e){return function(t){return t({type:Z,colorIndex:e+1})}}},ee={getRegionTableVisibility:function(e){return e.region.regionTableVisibility},getSelectedRegionIds:function(e){return e.region.selectedRegionIds},getNextRegionColorIndex:function(e){return e.region.nextRegionColorIndex}};var te={switchOnRegionTableVisibility:$.switchOnRegionTableVisibility,pushSelectedRegionIds:$.pushSelectedRegionId,incProductColorIndex:$.incRegionColorIndex,pushSelectedByRegionStations:k.pushSelectedByRegionStations},ne=Object(c.b)((function(e){return{selectedRegionIds:ee.getSelectedRegionIds(e),nextRegionColor:ee.getNextRegionColorIndex(e),currentUser:A.getCurrentUser(e)}}),te)((function(e){var t=e.selectedRegionIds,n=e.currentUser,c=e.nextRegionColor,o=e.incProductColorIndex,i=e.switchOnRegionTableVisibility,a=e.pushSelectedRegionIds,s=e.pushSelectedByRegionStations,u=Object(r.useState)([]),d=Object(v.a)(u,2),l=d[0],b=d[1],j=Object(r.useState)([]),O=Object(v.a)(j,2),f=O[0],h=O[1],g=Object(r.useState)(""),x=Object(v.a)(g,2),C=x[0],T=x[1];return Object(r.useEffect)(Object(y.a)(S.a.mark((function e(){var t,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.getAllRegions();case 2:t=e.sent,n=t.data.map((function(e){return{value:e._id,label:e.name}})),h(n),b(n);case 6:case"end":return e.stop()}}),e)}))),[]),Object(p.jsx)("div",{className:"site-input-group-wrapper",children:Object(p.jsx)(I.a,{dropdownMatchSelectWidth:252,style:{width:300},options:l,onSelect:function(e){e&&!t.includes(e)&&(s(e,n,c),i(),a(e),o(c)),console.log({selectedRegionIds:t})},onSearch:function(e){T(e);var t=f.filter((function(t){return t.label.toString().toLowerCase().indexOf(e.toString().toLowerCase())>-1}));b(t)},value:C,children:Object(p.jsx)(m.a.Search,{size:"large",placeholder:"\u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0440\u0435\u0433\u0438\u043e\u043d\u0430",enterButton:!0})})})}));var re=Object(c.b)((function(e){return{selectedByRegionStations:f.getSelectedByRegionStations(e)}}))((function(e){var t=e.selectedByRegionStations;return Object(p.jsx)(F.a,{columns:K,dataSource:t,size:"middle"})}));var ce=Object(c.b)((function(e){return{regionTableVisability:ee.getRegionTableVisibility(e)}}))((function(e){var t=e.regionTableVisability;return Object(p.jsxs)("div",{children:[Object(p.jsx)(ne,{}),t&&Object(p.jsx)(re,{className:u.a.table})]})})),oe=n(272),ie=n(56),ae=n(274),se=n(57);var ue=Object(c.b)((function(e){return{currentUser:A.getCurrentUser(e)}}))((function(e){var t=e.currentUser,n=function(){var e=Object(y.a)(S.a.mark((function e(n){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.userId=t._id,e.next=3,H.postNewStation(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)(oe.a,{labelCol:{span:7},wrapperCol:{span:14},layout:"horizontal",onFinish:n,onFinishFailed:function(e){console.log("Failed:",e)},children:[Object(p.jsx)(oe.a.Item,{label:"\u041f\u0440\u043e\u0434\u0443\u043a\u0442",name:"productName",children:Object(p.jsx)(m.a,{})}),Object(p.jsx)(oe.a.Item,{label:"\u0421\u0442\u0430\u043d\u0446\u0438\u044f",name:"stationName",children:Object(p.jsx)(m.a,{})}),Object(p.jsx)(oe.a.Item,{label:"\u041a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b",name:"place",children:Object(p.jsx)(m.a,{})}),Object(p.jsx)(oe.a.Item,{label:"\u0420\u0435\u0433\u0438\u043e\u043d",name:"region",children:Object(p.jsx)(m.a,{})}),Object(p.jsx)(oe.a.Item,{label:"\u0421\u043a\u043e\u043b\u044c\u043a\u043e \u043d\u0443\u0436\u043d\u043e",name:"needCount",children:Object(p.jsxs)(ie.a,{children:[Object(p.jsx)(ie.a.Option,{value:25,children:"25"}),Object(p.jsx)(ie.a.Option,{value:50,children:"50"}),Object(p.jsx)(ie.a.Option,{value:150,children:"150"}),Object(p.jsx)(ie.a.Option,{value:350,children:"350"}),Object(p.jsx)(ie.a.Option,{value:1e3,children:"1000"})]})}),Object(p.jsx)(oe.a.Item,{label:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e",name:"done",valuePropName:"checked",children:t._id!==M._id?Object(p.jsx)(z.a,{}):Object(p.jsx)(ae.a.Text,{children:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043e\u0439\u0442\u0438\u0442\u0435 :)"})}),Object(p.jsx)(oe.a.Item,{wrapperCol:{span:14,offset:7},children:Object(p.jsx)(se.a,{type:"primary",htmlType:"submit",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})]})})),de=n(276),le="SET_CURRENT_USER";var be={setCurrentUser:{setCurrentUser:function(e){return function(t){return fetch("".concat(R,"/user/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return t({type:le,currentUser:e})}))}}}.setCurrentUser},je=Object(c.b)((function(e){return{currentUser:A.getCurrentUser(e)}}),be)((function(e){var t=e.currentUser,n=e.setCurrentUser;return Object(p.jsxs)("div",{style:{display:"inline-block",flexFlow:"column wrap",float:"right"},children:[Object(p.jsx)(se.a,{size:"small",onClick:function(){n("60e06fe6ad2cc121d81eb19a")},style:{verticalAlign:"middle",margin:"5px",border:"none"},children:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u043b\u0430\u0441\u0442\u044c"}),Object(p.jsx)(de.a,{size:50,style:{backgroundColor:"#1890ff",verticalAlign:"middle"},children:t?t.name:"\u0413\u043e\u0441\u0442\u044c"})]})}));function pe(){return Object(p.jsx)("h1",{style:{color:"#2B90EE",height:"100%",width:"30%",float:"left"},children:" Tiny-map "})}function Oe(){return Object(p.jsxs)("div",{style:{width:"100%",height:"45px",justifyContent:"space-between",display:"flex"},children:[Object(p.jsx)(pe,{}),Object(p.jsx)(je,{})]})}var fe="CHANGE_ACTIVE_TAB",he={changeActiveTab:function(e){return function(t){return t({type:fe,newActiveTabKey:e})}}},ge=a.a.TabPane;var xe={changeActiveTab:he.changeActiveTab},Se=Object(c.b)(null,xe)((function(e){var t=e.changeActiveTab;return Object(p.jsxs)("div",{className:u.a.app,children:[Object(p.jsx)(g,{}),Object(p.jsxs)("div",{className:u.a.menu,children:[Object(p.jsx)(Oe,{}),Object(p.jsxs)(a.a,{defaultActiveKey:"1",onChange:function(e){t(e)},style:{margin:"0px"},children:[Object(p.jsx)(ge,{tab:"\u041f\u043e \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430\u043c",children:Object(p.jsx)(J,{})},d),Object(p.jsx)(ge,{tab:"\u041f\u043e \u0440\u0435\u0433\u0438\u043e\u043d\u0430\u043c",children:Object(p.jsx)(ce,{})},l),Object(p.jsx)(ge,{tab:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0441\u0442\u0430\u043d\u0446\u0438\u044e",children:Object(p.jsx)(ue,{})},"CREATE_STATION_TAB")]})]})]})})),ye=n(96),ve=n(160),Ie=n(161),me=n(24),Ce={currentUser:M},Te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,t=arguments.length>1?arguments[1]:void 0;return t.type===le?Object(me.a)(Object(me.a)({},e),{},{currentUser:t.currentUser}):e},Re=n(58),Pe={productTableVisibility:!1,selectedProductIds:[],nextProductColorIndex:0},_e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(me.a)(Object(me.a)({},e),{},{productTableVisibility:!0});case B:return Object(me.a)(Object(me.a)({},e),{},{selectedProductIds:[].concat(Object(Re.a)(e.selectedProductIds),[t.productId])});case N:return Object(me.a)(Object(me.a)({},e),{},{nextProductColorIndex:t.colorIndex});default:return e}},we={regionTableVisibility:!1,selectedRegionIds:[],nextRegionColorIndex:0},Be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return Object(me.a)(Object(me.a)({},e),{},{regionTableVisibility:!0});case Q:return Object(me.a)(Object(me.a)({},e),{},{selectedRegionIds:[].concat(Object(Re.a)(e.selectedRegionIds),[t.regionId])});case Z:return Object(me.a)(Object(me.a)({},e),{},{nextRegionColorIndex:t.colorIndex});default:return e}},Ne={selectedByProductStations:[],selectedByRegionStations:[]},Ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case V:return Object(me.a)(Object(me.a)({},e),{},{selectedByProductStations:[].concat(Object(Re.a)(e.selectedByProductStations),Object(Re.a)(t.stationsData))});case D:return Object(me.a)(Object(me.a)({},e),{},{selectedByRegionStations:[].concat(Object(Re.a)(e.selectedByRegionStations),Object(Re.a)(t.stationsData))});default:return e}},Ee={activeTab:d},Ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0;return t.type===fe?Object(me.a)(Object(me.a)({},e),{},{activeTab:t.newActiveTabKey}):e},Ve=Object(ye.combineReducers)({user:Te,product:_e,region:Be,station:Ue,tab:Ae}),De=Object(ye.createStore)(Ve,Object(ve.composeWithDevTools)(Object(ye.applyMiddleware)(Ie.a)));i.a.render(Object(p.jsx)(c.a,{store:De,children:Object(p.jsx)(Se,{})}),document.getElementById("root"))},54:function(e,t,n){e.exports={app:"styles_app__3KGpw",map:"styles_map__2fgSq",menu:"styles_menu__2asBd",table:"styles_table__CgVJA",username:"styles_username__2ib8x"}}},[[268,1,2]]]);
//# sourceMappingURL=main.bbcbffdd.chunk.js.map