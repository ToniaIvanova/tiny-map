(this["webpackJsonptiny-map"]=this["webpackJsonptiny-map"]||[]).push([[0],{136:function(e,t,n){},165:function(e,t,n){e.exports={"login-form":"LogIn_login-form__2cejJ"}},274:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(24),o=n(28),a=n.n(o),i=n(57),s=n.n(i),u=n(93),l="PRODUCT_TAB",d="REGION_TAB",b=["#dc143c","#3caa3c","#156fc1","#eaec35","#942010","#0b0038","#ffb21f","#ffbcb5v","#6ac954"],j=n(7);var p=function(e){var t=e.selectedStations;return Object(j.jsx)("div",{children:t.map((function(e){var t=e.done?"#c0c0c0":b[e.colorForMap];return Object(j.jsx)(u.b,{geometry:e.place,modules:["geoObject.addon.balloon","geoObject.addon.hint"],properties:{balloonContentHeader:"".concat(e.stationName),balloonContent:"\u041f\u0440\u043e\u0434\u0443\u043a\u0442: ".concat(e.productName," --- ").concat(e.done?"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e!":"\u041d\u0430\u0434\u043e: ".concat(e.needCount)),balloonContentFooter:e.region},options:{preset:"islands#circleIcon",iconColor:t}})}))})},O={getSelectedByProductStations:function(e){return e.station.selectedByProductStations},getSelectedByRegionStations:function(e){return e.station.selectedByRegionStations}},f={getActiveTab:function(e){return e.tab.activeTab}};var h=Object(c.b)((function(e){return{selectedByProductStations:O.getSelectedByProductStations(e),selectedByRegionStations:O.getSelectedByRegionStations(e),activeTab:f.getActiveTab(e)}}))((function(e){var t=e.selectedByProductStations,n=e.selectedByRegionStations,r=e.activeTab;return Object(j.jsx)(u.c,{children:Object(j.jsxs)(u.a,{className:s.a.map,defaultState:{center:[19.441468,17.496825],zoom:2},children:[r===l&&Object(j.jsx)(p,{selectedStations:t}),r===d&&Object(j.jsx)(p,{selectedStations:n})]})})})),g=n(19),x=n(134),m={getCurrentUser:function(e){return e.user.currentUser}},y=n(279),S=n(31),v=n.n(S),I=n(43),C=n(39),T=(n(101),n(136),n(276)),_=n(281),R=n(76),P=n(157),w="http://localhost:3001",N=n.n(P).a.create({baseURL:w,timeout:2e3,headers:{"Content-Type":"application/json"}}),B=new function e(){Object(R.a)(this,e),this.getAllProducts=Object(I.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N.get("/product"));case 1:case"end":return e.stop()}}),e)})))},U="SWITCH_ON_PRODUCT_TABLE_VISIBILITY",E="PUSH_SELECTED_PRODUCT_ID",A="INC_PRODUCT_COLOR_INDEX",V={switchOnProductTableVisibility:function(){return function(e){return e({type:U})}},pushSelectedProductId:function(e){return function(t){return t({type:E,productId:e})}},incProductColorIndex:function(e){return function(t){return t({type:A,colorIndex:e+1})}}},D={getProductTableVisibility:function(e){return e.product.productTableVisibility},getSelectedProductIds:function(e){return e.product.selectedProductIds},getNextProductColorIndex:function(e){return e.product.nextProductColorIndex}},L="PUSH_SELECTED_BY_PRODUCT_STATIONS",k="PUSH_SELECTED_BY_REGION_STATIONS",F={pushSelectedByProductStations:function(e,t,n){return function(r){return fetch("".concat(w,"/station/product/").concat(e,"/").concat(t._id),{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return r({type:L,stationsData:e.map((function(e){return e.colorForMap=n,e}))})}))}},pushSelectedByRegionStations:function(e,t,n){return function(r){return fetch("".concat(w,"/station/region/").concat(e,"/").concat(t._id),{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return r({type:k,stationsData:e.map((function(e){return e.colorForMap=n,e}))})}))}}};var z={switchOnProductTableVisibility:V.switchOnProductTableVisibility,pushSelectedProductIds:V.pushSelectedProductId,incNextProductColor:V.incProductColorIndex,pushSelectedByProductStations:F.pushSelectedByProductStations},G=Object(c.b)((function(e){return{selectedProductIds:D.getSelectedProductIds(e),nextProductColor:D.getNextProductColorIndex(e),currentUser:m.getCurrentUser(e)}}),z)((function(e){var t=e.selectedProductIds,n=e.currentUser,c=e.nextProductColor,o=e.incNextProductColor,a=e.switchOnProductTableVisibility,i=e.pushSelectedProductIds,s=e.pushSelectedByProductStations,u=Object(r.useState)([]),l=Object(C.a)(u,2),d=l[0],b=l[1],p=Object(r.useState)([]),O=Object(C.a)(p,2),f=O[0],h=O[1],g=Object(r.useState)(""),x=Object(C.a)(g,2),m=x[0],y=x[1];return Object(r.useEffect)((function(){var e=function(){var e=Object(I.a)(v.a.mark((function e(){var t,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.getAllProducts();case 2:t=e.sent,n=t.data.map((function(e){return{value:e._id,label:e.name}})),h(n),b(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(j.jsx)("div",{className:"site-input-group-wrapper",children:Object(j.jsx)(T.a,{dropdownMatchSelectWidth:252,style:{width:300},options:d,onSelect:function(e){e&&!t.includes(e)&&(s(e,n,c),a(),i(e),o(c))},onSearch:function(e){y(e);var t=f.filter((function(t){return t.label.toString().toLowerCase().indexOf(e.toString().toLowerCase())>-1}));b(t)},value:m,children:Object(j.jsx)(_.a.Search,{size:"large",placeholder:"\u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430",enterButton:!0})})})})),H=n(277),M=n(283),W=new function e(){Object(R.a)(this,e),this.postNewStation=function(){var e=Object(I.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N.post("/station",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.putStationDone=function(){var e=Object(I.a)(v.a.mark((function e(t){var n,r,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.stationId,r=t.currentUser,c=t.done,e.next=3,N.put("/station/".concat(n,"/").concat(r._id,"/done"),{done:c});case 3:return e.abrupt("return",e.sent.data.stationDone);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},J={_id:"6103dfdc5b78f439334b5825",name:"\u0413\u043e\u0441\u0442\u044c"};var K=Object(c.b)((function(e){return{currentUser:m.getCurrentUser(e)}}))((function(e){var t=e.station,n=e.currentUser;function r(e){W.putStationDone({stationId:t.stationId,currentUser:n,done:e})}return n===J?Object(j.jsx)("div",{}):t.done?Object(j.jsx)(M.a,{onChange:r,defaultChecked:!0}):Object(j.jsx)(M.a,{onChange:r})})),Y=[{title:"Product Name",dataIndex:"productName",sorter:function(e,t){return e.productName>t.productName?1:-1}},{title:"Station Name",dataIndex:"stationName"},{title:"Need Count",dataIndex:"needCount",defaultSortOrder:"descend",sorter:function(e,t){return e.needCount-t.needCount}},{title:"Done",render:function(e){return Object(j.jsx)(K,{station:e})}},{title:"region",dataIndex:"region",sorter:function(e,t){return e.region>t.region?1:-1}}];var X=Object(c.b)((function(e){return{selectedByProductStations:O.getSelectedByProductStations(e)}}))((function(e){var t=e.selectedByProductStations;return Object(j.jsx)(H.a,{columns:Y,dataSource:t,size:"middle"})}));var q=Object(c.b)((function(e){return{productTableVisability:D.getProductTableVisibility(e)}}))((function(e){var t=e.productTableVisability;return Object(j.jsxs)("div",{children:[Object(j.jsx)(G,{}),t&&Object(j.jsx)(X,{className:s.a.table})]})})),Z=new function e(){Object(R.a)(this,e),this.getAllRegions=Object(I.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N.get("/region"));case 1:case"end":return e.stop()}}),e)})))},Q="SWITCH_ON_REGION_TABLE_VISIBILITY",$="PUSH_SELECTED_REGIONS_ID",ee="INC_REGION_COLOR_INDEX",te={switchOnRegionTableVisibility:function(){return function(e){return e({type:Q})}},pushSelectedRegionId:function(e){return function(t){return t({type:$,regionId:e})}},incRegionColorIndex:function(e){return function(t){return t({type:ee,colorIndex:e+1})}}},ne={getRegionTableVisibility:function(e){return e.region.regionTableVisibility},getSelectedRegionIds:function(e){return e.region.selectedRegionIds},getNextRegionColorIndex:function(e){return e.region.nextRegionColorIndex}};var re={switchOnRegionTableVisibility:te.switchOnRegionTableVisibility,pushSelectedRegionIds:te.pushSelectedRegionId,incProductColorIndex:te.incRegionColorIndex,pushSelectedByRegionStations:F.pushSelectedByRegionStations},ce=Object(c.b)((function(e){return{selectedRegionIds:ne.getSelectedRegionIds(e),nextRegionColor:ne.getNextRegionColorIndex(e),currentUser:m.getCurrentUser(e)}}),re)((function(e){var t=e.selectedRegionIds,n=e.currentUser,c=e.nextRegionColor,o=e.incProductColorIndex,a=e.switchOnRegionTableVisibility,i=e.pushSelectedRegionIds,s=e.pushSelectedByRegionStations,u=Object(r.useState)([]),l=Object(C.a)(u,2),d=l[0],b=l[1],p=Object(r.useState)([]),O=Object(C.a)(p,2),f=O[0],h=O[1],g=Object(r.useState)(""),x=Object(C.a)(g,2),m=x[0],y=x[1];return Object(r.useEffect)((function(){var e=function(){var e=Object(I.a)(v.a.mark((function e(){var t,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.getAllRegions();case 2:t=e.sent,n=t.data.map((function(e){return{value:e._id,label:e.name}})),h(n),b(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(j.jsx)("div",{className:"site-input-group-wrapper",children:Object(j.jsx)(T.a,{dropdownMatchSelectWidth:252,style:{width:300},options:d,onSelect:function(e){e&&!t.includes(e)&&(s(e,n,c),a(),i(e),o(c)),console.log({selectedRegionIds:t})},onSearch:function(e){y(e);var t=f.filter((function(t){return t.label.toString().toLowerCase().indexOf(e.toString().toLowerCase())>-1}));b(t)},value:m,children:Object(j.jsx)(_.a.Search,{size:"large",placeholder:"\u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0440\u0435\u0433\u0438\u043e\u043d\u0430",enterButton:!0})})})}));var oe=Object(c.b)((function(e){return{selectedByRegionStations:O.getSelectedByRegionStations(e)}}))((function(e){var t=e.selectedByRegionStations;return Object(j.jsx)(H.a,{columns:Y,dataSource:t,size:"middle"})}));var ae=Object(c.b)((function(e){return{regionTableVisability:ne.getRegionTableVisibility(e)}}))((function(e){var t=e.regionTableVisability;return Object(j.jsxs)("div",{children:[Object(j.jsx)(ce,{}),t&&Object(j.jsx)(oe,{className:s.a.table})]})})),ie=n(278),se=n(59),ue=n(280),le=n(60);var de=Object(c.b)((function(e){return{currentUser:m.getCurrentUser(e)}}))((function(e){var t=e.currentUser,n=function(){var e=Object(I.a)(v.a.mark((function e(n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.userId=t._id,e.next=3,W.postNewStation(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsxs)(ie.a,{labelCol:{span:7},wrapperCol:{span:14},layout:"horizontal",onFinish:n,onFinishFailed:function(e){console.log("Failed:",e)},children:[Object(j.jsx)(ie.a.Item,{label:"\u041f\u0440\u043e\u0434\u0443\u043a\u0442",name:"productName",children:Object(j.jsx)(_.a,{})}),Object(j.jsx)(ie.a.Item,{label:"\u0421\u0442\u0430\u043d\u0446\u0438\u044f",name:"stationName",children:Object(j.jsx)(_.a,{})}),Object(j.jsx)(ie.a.Item,{label:"\u041a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b",name:"place",children:Object(j.jsx)(_.a,{})}),Object(j.jsx)(ie.a.Item,{label:"\u0420\u0435\u0433\u0438\u043e\u043d",name:"region",children:Object(j.jsx)(_.a,{})}),Object(j.jsx)(ie.a.Item,{label:"\u0421\u043a\u043e\u043b\u044c\u043a\u043e \u043d\u0443\u0436\u043d\u043e",name:"needCount",children:Object(j.jsxs)(se.a,{children:[Object(j.jsx)(se.a.Option,{value:25,children:"25"}),Object(j.jsx)(se.a.Option,{value:50,children:"50"}),Object(j.jsx)(se.a.Option,{value:150,children:"150"}),Object(j.jsx)(se.a.Option,{value:350,children:"350"}),Object(j.jsx)(se.a.Option,{value:1e3,children:"1000"})]})}),Object(j.jsx)(ie.a.Item,{label:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e",name:"done",valuePropName:"checked",children:t._id!==J._id?Object(j.jsx)(M.a,{}):Object(j.jsx)(ue.a.Text,{children:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043e\u0439\u0442\u0438\u0442\u0435 :)"})}),Object(j.jsx)(ie.a.Item,{wrapperCol:{span:14,offset:7},children:Object(j.jsx)(le.a,{type:"primary",htmlType:"submit",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})]})})),be=n(282),je="SET_CURRENT_USER",pe="LOG_IN",Oe={setCurrentUser:function(e){return function(t){return N.get("/user/".concat(e)).then((function(e){return t({type:je,currentUser:e})}))}},logIn:function(e,t){return function(n){return N.post("/user/login",{username:e,password:t}).then((function(e){return e.data})).then((function(e){return n({type:pe,currentUser:e})}))}}};var fe={setCurrentUser:Oe.setCurrentUser},he=Object(c.b)((function(e){return{currentUser:m.getCurrentUser(e)}}),fe)((function(e){var t=e.currentUser,n=e.setCurrentUser;return Object(j.jsxs)("div",{style:{display:"inline-block",flexFlow:"column wrap",float:"right"},children:[Object(j.jsx)(le.a,{size:"small",onClick:function(){n("60e06fe6ad2cc121d81eb19a")},style:{verticalAlign:"middle",margin:"5px",border:"none"},children:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u043b\u0430\u0441\u0442\u044c"}),Object(j.jsx)(be.a,{size:50,style:{backgroundColor:"#1890ff",verticalAlign:"middle"},children:t?t.name:"\u0413\u043e\u0441\u0442\u044c"})]})}));function ge(){return Object(j.jsx)("h1",{style:{color:"#2B90EE",height:"100%",width:"30%",float:"left"},children:" Tiny-map "})}function xe(){return Object(j.jsxs)("div",{style:{width:"100%",height:"45px",justifyContent:"space-between",display:"flex"},children:[Object(j.jsx)(ge,{}),Object(j.jsx)(he,{})]})}var me="CHANGE_ACTIVE_TAB",ye={changeActiveTab:function(e){return function(t){return t({type:me,newActiveTabKey:e})}}},Se=y.a.TabPane;var ve={changeActiveTab:ye.changeActiveTab},Ie=Object(c.b)(null,ve)((function(e){var t=e.changeActiveTab;return Object(j.jsxs)("div",{children:[Object(j.jsx)(xe,{}),Object(j.jsxs)(y.a,{defaultActiveKey:"1",onChange:function(e){t(e)},style:{margin:"0px"},children:[Object(j.jsx)(Se,{tab:"\u041f\u043e \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430\u043c",children:Object(j.jsx)(q,{})},l),Object(j.jsx)(Se,{tab:"\u041f\u043e \u0440\u0435\u0433\u0438\u043e\u043d\u0430\u043c",children:Object(j.jsx)(ae,{})},d),Object(j.jsx)(Se,{tab:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0441\u0442\u0430\u043d\u0446\u0438\u044e",children:Object(j.jsx)(de,{})},"CREATE_STATION_TAB")]})]})})),Ce=n(100),Te=n(165),_e=n.n(Te),Re={logIn:Oe.logIn},Pe=Object(c.b)(null,Re)((function(e){var t=e.logIn;return Object(j.jsxs)(ie.a,{labelCol:{span:7},wrapperCol:{span:14},name:"basic",onFinish:function(e){var n=e.username,r=e.password;t(n,r)},onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",className:_e.a["login-form"],children:[Object(j.jsx)(ie.a.Item,{label:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",name:"username",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}],children:Object(j.jsx)(_.a,{})}),Object(j.jsx)(ie.a.Item,{label:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"}],children:Object(j.jsx)(_.a.Password,{})}),Object(j.jsx)(ie.a.Item,{name:"remember",valuePropName:"checked",wrapperCol:{offset:7,span:14},children:Object(j.jsx)(Ce.a,{children:"\u0417\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c \u043c\u0435\u043d\u044f"})}),Object(j.jsx)(ie.a.Item,{wrapperCol:{offset:7,span:14},children:Object(j.jsx)(le.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})}));var we=Object(c.b)((function(e){return{currentUser:m.getCurrentUser(e)}}))((function(e){var t=e.currentUser;return Object(j.jsxs)("div",{className:s.a.app,children:[Object(j.jsx)(h,{}),Object(j.jsx)("div",{className:s.a.menu,children:t?Object(j.jsx)(x.a,{children:Object(j.jsxs)(g.d,{children:[Object(j.jsx)(g.b,{path:"/",element:Object(j.jsx)(Ie,{})}),Object(j.jsx)(g.b,{path:"*",element:Object(j.jsx)(g.a,{to:"/"})})]})}):Object(j.jsx)(x.a,{children:Object(j.jsxs)(g.d,{children:[Object(j.jsx)(g.b,{path:"/login",element:Object(j.jsx)(Pe,{})}),Object(j.jsx)(g.b,{path:"*",element:Object(j.jsx)(g.a,{to:"/login"})})]})})})]})})),Ne=n(99),Be=n(166),Ue=n(167),Ee=n(26),Ae={currentUser:null},Ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case pe:case je:return Object(Ee.a)(Object(Ee.a)({},e),{},{currentUser:t.currentUser});default:return e}},De=n(61),Le={productTableVisibility:!1,selectedProductIds:[],nextProductColorIndex:0},ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U:return Object(Ee.a)(Object(Ee.a)({},e),{},{productTableVisibility:!0});case E:return Object(Ee.a)(Object(Ee.a)({},e),{},{selectedProductIds:[].concat(Object(De.a)(e.selectedProductIds),[t.productId])});case A:return Object(Ee.a)(Object(Ee.a)({},e),{},{nextProductColorIndex:t.colorIndex});default:return e}},Fe={regionTableVisibility:!1,selectedRegionIds:[],nextRegionColorIndex:0},ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:return Object(Ee.a)(Object(Ee.a)({},e),{},{regionTableVisibility:!0});case $:return Object(Ee.a)(Object(Ee.a)({},e),{},{selectedRegionIds:[].concat(Object(De.a)(e.selectedRegionIds),[t.regionId])});case ee:return Object(Ee.a)(Object(Ee.a)({},e),{},{nextRegionColorIndex:t.colorIndex});default:return e}},Ge={selectedByProductStations:[],selectedByRegionStations:[]},He=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return Object(Ee.a)(Object(Ee.a)({},e),{},{selectedByProductStations:[].concat(Object(De.a)(e.selectedByProductStations),Object(De.a)(t.stationsData))});case k:return Object(Ee.a)(Object(Ee.a)({},e),{},{selectedByRegionStations:[].concat(Object(De.a)(e.selectedByRegionStations),Object(De.a)(t.stationsData))});default:return e}},Me={activeTab:l},We=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Me,t=arguments.length>1?arguments[1]:void 0;return t.type===me?Object(Ee.a)(Object(Ee.a)({},e),{},{activeTab:t.newActiveTabKey}):e},Je=Object(Ne.combineReducers)({user:Ve,product:ke,region:ze,station:He,tab:We}),Ke=Object(Ne.createStore)(Je,Object(Be.composeWithDevTools)(Object(Ne.applyMiddleware)(Ue.a)));a.a.render(Object(j.jsxs)(c.a,{store:Ke,children:[Object(j.jsx)(we,{}),Object(j.jsx)("style",{children:"#root {width: 100%} "})]}),document.getElementById("root"))},57:function(e,t,n){e.exports={app:"styles_app__2MKbF",map:"styles_map__tTZXH",menu:"styles_menu__2uBzr",table:"styles_table__3ijJi",username:"styles_username__39I6e"}}},[[274,1,2]]]);
//# sourceMappingURL=main.13662f09.chunk.js.map